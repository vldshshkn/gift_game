<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–ü–æ–π–º–∞–π –≤—Å–µ 7 –ø–æ–¥–∞—Ä–∫–æ–≤!</title>
  <style>
    body {
      margin: 0;
      font-family: 'Press Start 2P', cursive;
      background: black;
      color: white;
      overflow: hidden;
    }
    #game {
      position: relative;
      width: 100vw;
      height: 100vh;
    }
    .emoji {
      position: absolute;
      font-size: 2rem;
      animation: fall linear;
    }
    @keyframes fall {
      0% { top: -50px; }
      100% { top: 100vh; }
    }
    #basket {
      position: absolute;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 2rem;
    }
    #scoreboard {
      position: absolute;
      bottom: 10px;
      left: 10px;
      font-size: 1rem;
    }
    #message {
      position: absolute;
      top: 40%;
      width: 100%;
      text-align: center;
      font-size: 1.2rem;
      display: none;
    }
    #message button {
      font-size: 1rem;
      margin: 1rem;
    }
    #title {
      text-align: center;
      padding-top: 10px;
      font-size: 1rem;
    }
  </style>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
</head>
<body>
  <div id="title">–ú–æ–ª–æ–¥–µ—Ü, –≤–æ—Ç –µ—â–µ –æ–¥–Ω–æ –∑–∞–¥–∞–Ω–∏–µ. –ü–æ–π–º–∞–π –≤—Å–µ 7 –ø–æ–¥–∞—Ä–∫–æ–≤!</div>
  <div id="game">
    <div id="basket">üß∫</div>
    <div id="scoreboard">–ü–æ–π–º–∞–Ω–æ: 0 / 7</div>
    <div id="message">
      <div id="resultText"></div>
      <button onclick="restartGame()">–ï—â–µ —Ä–∞–∑?</button>
    </div>
  </div>
  <audio id="bg-music" src="—Ñ–æ–Ω–æ–≤–∞—è.wav" loop autoplay></audio>
  <audio id="catch-sound" src="–∫–æ–≥–¥–∞ –ª–æ–≤–∏—Ç –ø–æ–¥–∞—Ä–æ–∫.wav"></audio>
  <audio id="lose-sound" src="–ø—Ä–æ–∏–≥—Ä—ã—à.wav"></audio>
  <audio id="win-sound" src="–§–∏–Ω–∞–ª—å–Ω–∞—è –ø–æ–±–µ–¥–∞.wav"></audio>
  <script>
    const game = document.getElementById('game');
    const basket = document.getElementById('basket');
    const scoreboard = document.getElementById('scoreboard');
    const message = document.getElementById('message');
    const resultText = document.getElementById('resultText');

    const bgMusic = document.getElementById('bg-music');
    const catchSound = document.getElementById('catch-sound');
    const loseSound = document.getElementById('lose-sound');
    const winSound = document.getElementById('win-sound');

    const giftEmoji = 'üéÅ';
    const otherEmojis = ['üçï', 'üê∂', 'üí©', 'üçî', 'üöÄ', 'üëæ', 'üòà', 'üéÉ'];

    let caughtGifts = 0;
    let caughtSet = new Set();
    let gameInterval;

    function spawnEmoji() {
      const emoji = document.createElement('div');
      const isGift = Math.random() < 0.25;
      emoji.textContent = isGift ? giftEmoji : otherEmojis[Math.floor(Math.random() * otherEmojis.length)];
      emoji.className = 'emoji';
      emoji.style.left = Math.random() * 90 + 'vw';
      emoji.style.animationDuration = (2 + Math.random() * 3) + 's';
      game.appendChild(emoji);

      const fallDuration = parseFloat(emoji.style.animationDuration) * 1000;
      const timer = setTimeout(() => game.removeChild(emoji), fallDuration);

      emoji.addEventListener('click', () => {
        clearTimeout(timer);
        if (emoji.textContent === giftEmoji) {
          catchSound.play();
          caughtSet.add(emoji.textContent + Math.random());
          caughtGifts = caughtSet.size;
        }
        game.removeChild(emoji);
        scoreboard.textContent = `–ü–æ–π–º–∞–Ω–æ: ${caughtGifts} / 7`;

        if (caughtGifts >= 7) {
          win();
        }
      });
    }

    function win() {
      clearInterval(gameInterval);
      bgMusic.pause();
      winSound.play();
      message.style.display = 'block';
      resultText.textContent = '–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—Å–µ –ø–æ–¥–∞—Ä–∫–∏ –ø–æ–π–º–∞–Ω—ã!';
      setTimeout(() => {
        window.location.href = 'https://vldshshkn.github.io/safe_game/';
      }, 5000);
    }

    function lose() {
      clearInterval(gameInterval);
      bgMusic.pause();
      loseSound.play();
      message.style.display = 'block';
      resultText.textContent = '–í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏. –ï—â–µ —Ä–∞–∑?';
    }

    function restartGame() {
      message.style.display = 'none';
      caughtGifts = 0;
      caughtSet.clear();
      scoreboard.textContent = '–ü–æ–π–º–∞–Ω–æ: 0 / 7';
      bgMusic.currentTime = 0;
      bgMusic.play();
      gameInterval = setInterval(spawnEmoji, 1000);
    }

    document.addEventListener('DOMContentLoaded', () => {
      restartGame();
      document.addEventListener('mousemove', e => {
        basket.style.left = (e.clientX - 20) + 'px';
      });
    });
  </script>
</body>
</html>
